{% extends "frontend/base.html" %}

{% load static %}

{% block title %}
Arqam House
{% endblock title %}

{% block footer %}
{% include "frontend/footer.html" %}
{% endblock footer %}

{% block styles %}

{% endblock styles %}

{% block top_page_scripts %}
<script src="https://kit.fontawesome.com/71fc1e3551.js" crossorigin="anonymous"></script>
{% endblock top_page_scripts %}

{% block scripts %}
<script>
function GetHouses(object) {

    var token = '{{ csrf_token }}';

    var search = object.value;
    console.log(search)

    const url = "{{ request.path }}";

    let data = {
        search: search
    }

    let fetchData = {
        method: 'POST',
        body: JSON.stringify(data),
        credentials: 'include',
        headers: { 
            'X-CSRFToken': token,
            'Content-Type': 'application/json; charset=utf-8',
            'X-Requested-With': 'XMLHttpRequest'
        },
        
    }
    
    fetch(url, fetchData)
        .then(
            function (response) {
                if (response.status !== 200) {
                    console.log('Looks like there was a problem. Status Code: ' +
                        response.status);
                    return;
                }

                // Examine the text in the response
                response.json().then(function (data) {
                    console.log(data)
                    document.getElementById("dynamic").innerHTML = data['html'];
                });
            }
        )
        .catch(function (err) {
            console.log('Fetch Error :-S', err);
        });

}
</script>

{% endblock scripts %}

{% block content %}
<section style="padding-bottom: 100px;padding-top: 80px;">
	<div class="container">
		
		<div class="row justify-content-center" style="padding-bottom: 20px;">
			<div class="col-lg-2 col-md-3 col-sm-4 col-5">
				<a href="{% url 'home' %}"><img src="{% static 'images/logo.png' %}"></a>
			</div>
		</div>

        <form method="POST">{% csrf_token %}
		<div class="row justify-content-center" style="padding-bottom: 30px;">
			<div class="col-lg-8 col-md-10 ">
                <input type="text" placeholder="Search for a house.." id="house_search" onkeyup="GetHouses(this);">
			</div>
		</div>
        </form>

		<div id="dynamic" style="padding-bottom: 300px;">
            <div class="row justify-content-center" style="padding: 10px;">
                <div class="col-lg-8 col-md-10 boxed boxed--border bg--secondary boxed--lg box-shadow" 
                    style="box-shadow: 0px 10px 15px 10px rgba(0, 0, 0, 0.05);border-radius: 10px;margin-bottom: 20px;padding: 20px;">
                    
                        <div class="row" style="padding-bottom: 5px;padding-left: 10px;padding-right: 10px;">
                            {% if default_house.logo %}
                            <div class="col-lg-4 col-md-4 col-sm-6 col-6">
                                <a href="{{ default_house.get_home_page_url }}">
                                    <img src="{{ default_house.logo.url }}">
                                </a>
                                
                                <p style="font-size: 1.2rem;margin-top: 10px;">{{ default_house.name }}</p>
                            </div>
                            {% endif %}
                            
                            <div class="col-lg-8 col-md-8 col-sm-6 col-6" style="text-align: right;align-self: center;">
                                <p class="lead" style="margin-bottom: 0px;">23</p>
                                <p style="font-size: 0.5rem;">Subscribers</p>
                            </div>
                            
                        </div>
                        <div class="row" style="padding-left: 10px;padding-right: 10px;";">
                            <div class="col-3">
                                
                            </div>
                        </div>
                    
                </div>
            </div>
        </div>

			
	</div>
</section>



{% endblock content %}